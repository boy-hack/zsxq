# 配置管理

## 扫描配置概述

w15scan可以对扫描的web指纹、端口指纹、poc、敏感文件扫描规则、http爬虫规则、字典等进行自定义配置。自定义配置的越详细，扫描结果会越好。

## 指纹配置

### Web指纹管理

支持对重点指纹进行颜色区分，项目显示时会也区分颜色，内置指纹可能有重复，需要自己维护。

![指纹配置1](image-placeholder.png)

![指纹配置2](image-placeholder.png)

### 指纹规则特点

- **多源指纹库**：集成多个开源指纹库
- **颜色标识**：重点指纹可设置颜色区分
- **自定义规则**：支持用户自定义指纹规则
- **实时更新**：指纹库支持在线更新
- **去重管理**：内置指纹可能有重复，需要自己维护

### 指纹匹配方式

- **HTTP响应头匹配**
- **页面内容匹配**
- **favicon图标匹配**
- **JS文件特征匹配**
- **URL路径特征匹配**

## 端口指纹配置

规则来自nmap，去除了nmap特征以避免被检测。

![端口指纹](image-placeholder.png)

### 端口指纹特点

- **基于nmap规则**：继承nmap强大的指纹识别能力
- **特征去除**：去除nmap特征，避免被目标检测
- **服务识别**：准确识别端口上运行的服务
- **版本检测**：识别服务版本信息

### 支持的服务类型

- **Web服务**：HTTP、HTTPS、各种Web服务器
- **数据库**：MySQL、PostgreSQL、Redis、MongoDB等
- **邮件服务**：SMTP、POP3、IMAP等
- **文件服务**：FTP、SSH、SMB等
- **其他服务**：DNS、SNMP、RDP等

## PoC管理

poc来自nuclei-template项目，程序会自动关联指纹-poc，也可以自己关联。

![PoC管理](image-placeholder.png)

### PoC关联配置

PoC需要关联指纹，关联指纹后一键PoC扫描会对WEB对应指纹使用对应的PoC。

![PoC关联](image-placeholder.png)

### PoC分类

- **SQL注入**：各种SQL注入检测PoC
- **XSS跨站脚本**：反射型、存储型XSS检测
- **文件上传**：文件上传漏洞检测
- **命令执行**：RCE、命令注入检测
- **信息泄露**：敏感信息暴露检测
- **中间件漏洞**：各种中间件已知漏洞

### PoC管理功能

- **自动关联**：根据指纹自动关联对应PoC
- **手动配置**：支持手动配置指纹-PoC关联
- **批量管理**：支持批量导入导出PoC规则
- **优先级设置**：可设置PoC执行优先级

## 字典配置

用于配置一些常见的扫描字典。

![字典配置](image-placeholder.png)

### 字典类型

#### 子域名字典

- **内置10w+子域名字典**
- **分级字典**：常用、全面、极大三个级别
- **自定义字典**：支持导入自定义子域名字典

#### 目录字典

- **常见目录**：admin、backup、test等常见目录
- **框架目录**：各种开发框架的特有目录
- **敏感目录**：可能包含敏感信息的目录

#### 文件字典

- **敏感文件**：备份文件、配置文件、日志文件
- **常见文件**：robots.txt、sitemap.xml等
- **开发文件**：源码文件、临时文件

#### 用户名密码字典

- **弱密码字典**：常见弱密码组合
- **默认密码**：各种设备和服务的默认密码
- **社工字典**：基于目标信息生成的字典

### 字典管理

- **在线更新**：支持从远程更新字典
- **本地导入**：支持导入本地字典文件
- **字典合并**：支持多个字典合并去重
- **字典分组**：按用途分组管理字典

## 通知机器人配置

详细的通知源接入，监控、任务完成随时可知。

![通知机器人](image-placeholder.png)

### 支持的通知方式

#### 钉钉机器人

- **群机器人**：支持钉钉群机器人通知
- **自定义关键词**：支持自定义触发关键词
- **@指定人员**：支持@指定群成员

#### 企业微信

- **群机器人**：支持企业微信群机器人
- **应用消息**：支持企业微信应用消息推送

#### 邮件通知

- **SMTP配置**：支持各种邮件服务商
- **HTML格式**：支持富文本邮件格式
- **附件支持**：支持发送报告附件

#### Webhook

- **自定义Webhook**：支持自定义HTTP回调
- **数据格式**：JSON、表单等多种数据格式
- **重试机制**：支持失败重试

### 通知内容配置

- **资产变更通知**：新发现资产、资产状态变更
- **漏洞发现通知**：发现高危、中危漏洞时通知
- **任务完成通知**：扫描任务完成状态通知
- **系统状态通知**：系统异常、节点离线等状态

## 扫描规则配置

### HTTP爬虫规则

#### 爬虫行为配置

- **爬虫深度**：设置最大爬虫深度
- **并发数量**：设置爬虫并发数量
- **延迟设置**：设置请求间隔
- **User-Agent**：自定义请求头

#### 内容过滤规则

- **文件类型过滤**：过滤图片、视频等无用文件
- **URL过滤**：过滤logout、delete等危险URL
- **内容长度**：过滤过长或过短的响应

#### 数据提取规则

- **链接提取**：提取页面中的所有链接
- **表单提取**：提取表单和参数信息
- **JS分析**：分析JavaScript中的API接口
- **敏感信息**：提取邮箱、密钥等敏感信息

### 敏感文件扫描规则

#### 文件类型

- **备份文件**：.bak、.backup、.old等后缀
- **配置文件**：config.php、web.config等
- **日志文件**：access.log、error.log等
- **源码文件**：.git、.svn、.DS_Store等

#### 扫描策略

- **常见路径**：扫描常见的敏感文件路径
- **目录遍历**：尝试访问上级目录
- **文件猜测**：基于已知文件猜测其他文件

## 配置导入导出

### 配置备份

- **完整备份**：备份所有配置文件
- **增量备份**：只备份变更的配置
- **定时备份**：设置定时自动备份

### 配置迁移

- **版本兼容**：支持不同版本间配置迁移
- **选择性导入**：可选择导入特定配置模块
- **配置验证**：导入前验证配置文件正确性

### 配置同步

- **实时同步**：配置变更实时同步到扫描节点
- **批量下发**：向多个节点批量下发配置
- **版本管理**：保存配置历史版本 